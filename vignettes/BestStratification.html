<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Giulio Barcaroli" />

<meta name="date" content="2024-09-10" />

<title>Best stratification of a sampling frame</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Best stratification of a sampling
frame</h1>
<h4 class="author">Giulio Barcaroli</h4>
<h4 class="date">2024-09-10</h4>



<p>Given a sampling survey, with specific precision constraints on the
target estimates, the best stratification of a sampling frame is the one
that ensures the minimum sample cost under the condition to satisfy
those precision constraints.</p>
<p>In this vignette, we compare the performance of the general purpose
Quantum Genetic Algorithm, versus the R package SamplingStrata, that is
specialized for this task.</p>
<div id="prepare-the-data" class="section level2">
<h2>Prepare the data</h2>
<p>For this example, we make use of the “iris” dataset, that is
considered as the sampling frame. A survey will make use of a sample
selected from the frame, to produce estimates of the four target
variables (petal length and width, sepal length and width), with a
maximum allowable coefficient of variation of 3% on these estimates.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Sampling frame</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>iris<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(iris))</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>iris<span class="sc">$</span>dom <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>frame <span class="ot">&lt;-</span> <span class="fu">buildFrameDF</span>(</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="at">df =</span> iris,</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="at">id =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="at">domainvalue =</span> <span class="st">&quot;dom&quot;</span>,</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">c</span>(<span class="st">&quot;id&quot;</span>),</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">c</span>(<span class="st">&quot;Sepal.Length&quot;</span>, <span class="st">&quot;Sepal.Width&quot;</span>, <span class="st">&quot;Petal.Length&quot;</span>, <span class="st">&quot;Petal.Width&quot;</span>)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>)</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="fu">head</span>(frame)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#&gt;   id X1  Y1  Y2  Y3  Y4 domainvalue</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt; 1  1  1 5.1 3.5 1.4 0.2           1</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt; 2  2  2 4.9 3.0 1.4 0.2           1</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co">#&gt; 3  3  3 4.7 3.2 1.3 0.2           1</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#&gt; 4  4  4 4.6 3.1 1.5 0.2           1</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co">#&gt; 5  5  5 5.0 3.6 1.4 0.2           1</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#&gt; 6  6  6 5.4 3.9 1.7 0.4           1</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Precision constraints</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">list</span>(</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">DOM =</span> <span class="st">&quot;DOM1&quot;</span>,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">CV1 =</span> <span class="fl">0.03</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">CV2 =</span> <span class="fl">0.03</span>,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">CV3 =</span> <span class="fl">0.03</span>,</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="at">CV4 =</span> <span class="fl">0.03</span>,</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="at">domainvalue =</span> <span class="dv">1</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>))</span></code></pre></div>
<p>Given these input data, we want to stratify the sampling frame (the
“iris” dataset) obtaining 3 different optimized strata:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>nstrat <span class="ot">=</span> <span class="dv">3</span></span></code></pre></div>
</div>
<div id="qga-solution" class="section level1">
<h1>QGA solution</h1>
<div id="fitness-evaluation" class="section level2">
<h2>Fitness evaluation</h2>
<p>The following fitness evaluation function is defined:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>BestStratification <span class="ot">&lt;-</span> <span class="cf">function</span>(solution,</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                               eval_func_inputs) {</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  frame <span class="ot">&lt;-</span> eval_func_inputs[[<span class="dv">1</span>]]</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  cv <span class="ot">&lt;-</span> eval_func_inputs[[<span class="dv">2</span>]]</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  strata <span class="ot">=</span> SamplingStrata<span class="sc">::</span><span class="fu">aggrStrata2</span>(<span class="at">dataset=</span>frame,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>                                       <span class="at">model=</span><span class="cn">NULL</span>,</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>                                       <span class="at">vett=</span>solution,</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>                                       <span class="at">dominio=</span><span class="dv">1</span>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  fitness <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">sum</span>(SamplingStrata<span class="sc">::</span><span class="fu">bethel</span>(strata, cv, <span class="at">realAllocation =</span> <span class="cn">TRUE</span>))</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="fu">return</span>(fitness)</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>}</span></code></pre></div>
<p>This function receives as input parameters:</p>
<ul>
<li>solution (a vector that associates to each unit in the frame, the
stratum it belongs to);</li>
<li>the frame dataset;</li>
<li>the precisione constraints.</li>
</ul>
<p>Using the function “aggrStrata2” of SamplingStrata, the aggregate
strata based on the current solution is obtained. Another SamplingStrata
function (“bethel”) calculates the sample size required by this
solution, which the valued of the fitness.</p>
</div>
<div id="optimization" class="section level2">
<h2>Optimization</h2>
<p>We define the Genome parameter as the number of units in the frame,
while the number of values to be associated to each element in the
Genome is set equal to the number of desired strata (3). This means that
each solution is a vector of 150 elements, each one with an assigned
value from 1 to 3: each couple element/value indicates the stratum to
which the unit in the frame belongs. In this setting, we do not want to
introduce the mutation operator. Moreover, we want to iterate 1000
times, each time considering 20 generated solutions.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>solutionQGA <span class="ot">&lt;-</span> <span class="fu">QGA</span>(<span class="at">popsize=</span><span class="dv">20</span>,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                <span class="at">generation_max =</span> <span class="dv">2000</span>,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>                <span class="at">nvalues_sol =</span> nstrat,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>                <span class="at">Genome =</span> <span class="fu">nrow</span>(iris),</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>                <span class="at">thetainit =</span> <span class="fl">3.1415926535</span> <span class="sc">*</span> <span class="fl">0.15</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>                <span class="at">thetaend =</span> <span class="fl">3.1415926535</span> <span class="sc">*</span> <span class="fl">0.0125</span>,</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>                <span class="at">pop_mutation_rate_init =</span> <span class="dv">1</span><span class="sc">/</span>(popsize <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>                <span class="at">pop_mutation_rate_end =</span> <span class="dv">1</span><span class="sc">/</span>(popsize <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>                <span class="at">mutation_rate_init =</span> <span class="dv">1</span><span class="sc">/</span>(Genome <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>                <span class="at">mutation_rate_end =</span> <span class="dv">1</span><span class="sc">/</span>(Genome <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>                <span class="at">mutation_flag =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>                <span class="at">plotting =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>                <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>                <span class="at">eval_fitness =</span> BestStratification,</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>                <span class="at">eval_func_inputs =</span> <span class="fu">list</span>(frame, cv))</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>QGA<span class="sc">:::</span><span class="fu">plot_Output</span>(solutionQGA[[<span class="dv">2</span>]])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The plot indicates that the number of iterations was enough to obtain
a solution that is likely to be no further improved.</p>
</div>
<div id="analysis-of-the-solution" class="section level2">
<h2>Analysis of the solution</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>solution_QGA <span class="ot">&lt;-</span> solutionQGA[[<span class="dv">1</span>]]</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>strata <span class="ot">&lt;-</span> <span class="fu">aggrStrata2</span>(<span class="at">dataset =</span> frame, </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                      <span class="at">vett =</span> solution_QGA, </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                      <span class="at">dominio =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>The sample size required to produce estimates compliant with the
given precision constraints is:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">bethel</span>(strata, cv, <span class="at">realAllocation =</span> <span class="cn">TRUE</span>))</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; [1] 19.75488</span></span></code></pre></div>
<p>we can compare the obtained optimal stratification with the variable
“Species” in the dataset:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>iris<span class="sc">$</span>stratum <span class="ot">&lt;-</span> solution_QGA</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">table</span>(iris<span class="sc">$</span>Species, iris<span class="sc">$</span>stratum)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt;             </span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt;               1  2  3</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt;   setosa      0 50  0</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt;   versicolor  2  0 48</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt;   virginica  46  0  4</span></span></code></pre></div>
<p>We observe that the optimized strata almost exactly replicatte the
variable Species.</p>
</div>
</div>
<div id="samplingstrata-solution" class="section level1">
<h1>SamplingStrata solution</h1>
<p>We perform the optimization:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>solution_SamplingStrata <span class="ot">&lt;-</span> <span class="fu">optimStrata</span>(<span class="at">method =</span> <span class="st">&quot;atomic&quot;</span>,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                  <span class="at">framesamp =</span> frame,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                  <span class="at">nStrata =</span> nstrat,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>                  <span class="at">errors =</span> cv,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>                  <span class="at">pops =</span> popsize,</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>                  <span class="at">minnumstr =</span> <span class="dv">1</span>,</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>                  <span class="at">iter =</span> <span class="dv">2000</span>)</span></code></pre></div>
<p>with the resulting sample size:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">sum</span>(solution_SamplingStrata<span class="sc">$</span>aggr_strata<span class="sc">$</span>SOLUZ)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; [1] 19.86479</span></span></code></pre></div>
<p>slightly higher than the QGA solution.</p>
<p>As for the optimal stratification:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>iris<span class="sc">$</span>stratum <span class="ot">&lt;-</span> solution_SamplingStrata<span class="sc">$</span>framenew<span class="sc">$</span>LABEL</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">table</span>(iris<span class="sc">$</span>Species, iris<span class="sc">$</span>stratum)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt;             </span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt;               1  2  3</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt;   setosa      6  5 39</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt;   versicolor 40  3  7</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt;   virginica   4 45  1</span></span></code></pre></div>
<p>it is rather different from the “Species” variable.</p>
<p>As a conclusion, we can say that both optimization algorithms are
efficient (they yield the same sample size), but the QGA can better
reproduce the “natural” stratification of the “iris” dataset.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
