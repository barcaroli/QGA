<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clustering • QGA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Clustering">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">QGA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/QGA.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/airlines_hubs.html">Airline hubs</a>
    </li>
    <li>
      <a href="../articles/clustering.html">Clustering</a>
    </li>
    <li>
      <a href="../articles/functionMax.html">Maximum of a function</a>
    </li>
    <li>
      <a href="../articles/TSP.html">Traveller Salesman</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/barcaroli/QGA/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Clustering</h1>
                        <h4 data-toc-skip class="author">Giulio
Barcaroli</h4>
            
            <h4 data-toc-skip class="date">2025-09-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/barcaroli/QGA/blob/main/vignettes/clustering.Rmd" class="external-link"><code>vignettes/clustering.Rmd</code></a></small>
      <div class="hidden name"><code>clustering.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="clustering">Clustering<a class="anchor" aria-label="anchor" href="#clustering"></a>
</h2>
<p>“Cluster analysis or clustering is the task of grouping a set of
objects in such a way that objects in the same group (called a cluster)
are more similar (in some specific sense defined by the analyst) to each
other than to those in other groups (clusters).” (from Wikipedia). In
our study, we consider the multivariate case, where clustering is done
considering more than one variable. First, we apply the Quantum Genetic
Algorithm, then a classical GA, and compare their results.</p>
<div class="section level3">
<h3 id="prepare-data">Prepare data<a class="anchor" aria-label="anchor" href="#prepare-data"></a>
</h3>
<p>We make use of the “iris” dataset:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">vars</span></span>
<span><span class="co">#&gt; [1] "Sepal.Length" "Sepal.Width"  "Petal.Length" "Petal.Width"</span></span></code></pre></div>
<p>The above four variables will be used in clustering.</p>
</div>
<div class="section level3">
<h3 id="quantum-ga-application">Quantum GA application<a class="anchor" aria-label="anchor" href="#quantum-ga-application"></a>
</h3>
<div class="section level4">
<h4 id="fitness-evaluation">Fitness evaluation<a class="anchor" aria-label="anchor" href="#fitness-evaluation"></a>
</h4>
<p>The following fitness evaluation function is defined:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clustering</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">solution</span>, <span class="va">eval_func_inputs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">maxvalue</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span>  <span class="va">penalfactor</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">eval_func_inputs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">vars</span> <span class="op">&lt;-</span> <span class="va">eval_func_inputs</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="co"># Fitness function</span></span>
<span>  <span class="va">fitness</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">v</span> <span class="kw">in</span> <span class="va">vars</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="va">v</span><span class="op">]</span>,<span class="va">solution</span>,FUN<span class="op">=</span><span class="va">sd</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="va">v</span><span class="op">]</span>,<span class="va">solution</span>,FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span>    <span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span>,<span class="va">maxvalue</span>,<span class="va">cv</span><span class="op">)</span></span>
<span>    <span class="va">fitness</span> <span class="op">&lt;-</span> <span class="va">fitness</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># Penalization on unbalanced clusters</span></span>
<span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">solution</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span>  <span class="va">fitness</span> <span class="op">&lt;-</span> <span class="va">fitness</span> <span class="op">+</span> <span class="va">penalfactor</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">b</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="va">fitness</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This function receives as input parameters:</p>
<ul>
<li>solution (the current solution to be evaluated)</li>
<li>eval_func_inputs (a list including the dataframe to be analyzed, and
the set of variables to be considered in the clustering)</li>
</ul>
</div>
<div class="section level4">
<h4 id="optimization">Optimization<a class="anchor" aria-label="anchor" href="#optimization"></a>
</h4>
<p>We define the Genome parameter as the number of entries in the “iris”
dataset. The number of values is set equal to the 3. This means that
each solution is a vector of 150 elements, each one with an assigned
value from 1 to 3: each couple element/value indicates which entry
(element) is assigned to which cluster (value).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nclust</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="va">popsize</span> <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="va">Genome</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">CLUSTsolution</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/QGA.html">QGA</a></span><span class="op">(</span><span class="va">popsize</span>,</span>
<span>                generation_max <span class="op">=</span> <span class="fl">1500</span>,</span>
<span>                nvalues_sol <span class="op">=</span> <span class="va">nclust</span>,</span>
<span>                <span class="va">Genome</span>,</span>
<span>                thetainit <span class="op">=</span> <span class="fl">3.1415926535</span> <span class="op">*</span> <span class="fl">0.1</span>,</span>
<span>                thetaend <span class="op">=</span> <span class="fl">3.1415926535</span> <span class="op">*</span> <span class="fl">0.05</span>,</span>
<span>                pop_mutation_rate_init <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">popsize</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                pop_mutation_rate_end <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">popsize</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                mutation_rate_init <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">Genome</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                mutation_rate_end <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">Genome</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                mutation_flag <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                plotting <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                progress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                eval_fitness <span class="op">=</span> <span class="va">clustering</span>,</span>
<span>                eval_func_inputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">iris</span>, <span class="va">vars</span><span class="op">)</span>,</span>
<span>                stop_iters <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="analysis-of-the-solution">Analysis of the solution<a class="anchor" aria-label="anchor" href="#analysis-of-the-solution"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">QGA</span><span class="fu">:::</span><span class="fu">plot_Output</span><span class="op">(</span><span class="va">CLUSTsolution</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="clustering_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<p>The plot indicates that the number of iterations was enough to obtain
a solution that is likely to be no further improved.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">solution</span> <span class="op">&lt;-</span> <span class="va">CLUSTsolution</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">fitnessQGA</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">iris</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">v</span> <span class="kw">in</span> <span class="va">vars</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="va">v</span><span class="op">]</span>,<span class="va">solution</span>,FUN<span class="op">=</span><span class="va">sd</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="va">v</span><span class="op">]</span>,<span class="va">solution</span>,FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span>,<span class="va">maxvalue</span>,<span class="va">cv</span><span class="op">)</span></span>
<span>  <span class="va">fitnessQGA</span> <span class="op">&lt;-</span> <span class="va">fitnessQGA</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">fitnessQGA</span></span>
<span><span class="co">#&gt; [1] 1.62336</span></span></code></pre></div>
<p>We can try to understand the quality of these clusters by comparing
them to the “Species” variable in the dataset:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="va">solution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">Species</span> <span class="op">+</span> <span class="va">cluster</span>, data<span class="op">=</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">#&gt;             cluster</span></span>
<span><span class="co">#&gt; Species       1  2  3</span></span>
<span><span class="co">#&gt;   setosa      0  0 50</span></span>
<span><span class="co">#&gt;   versicolor 45  5  0</span></span>
<span><span class="co">#&gt;   virginica   5 45  0</span></span></code></pre></div>
<p>It seems that the cluster values can predict quite well the Species
of the iris flowers, with only 10 misclassifications out of 150.</p>
</div>
</div>
<div class="section level3">
<h3 id="classical-ga-application">Classical GA application<a class="anchor" aria-label="anchor" href="#classical-ga-application"></a>
</h3>
<p>We can now compare these results with those obtained by a classical
genetic algorithm, the one implemented in the R package “genalg”.</p>
<div class="section level4">
<h4 id="fitness-evaluation-1">Fitness evaluation<a class="anchor" aria-label="anchor" href="#fitness-evaluation-1"></a>
</h4>
<p>The fitness function:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">evaluate</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">solution</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">solution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">solution</span><span class="op">)</span></span>
<span>  <span class="va">maxvalue</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span>  <span class="va">penalfactor</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span>  <span class="va">fitness</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">v</span> <span class="kw">in</span> <span class="va">vars</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="va">v</span><span class="op">]</span>,<span class="va">solution</span>,FUN<span class="op">=</span><span class="va">sd</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="va">v</span><span class="op">]</span>,<span class="va">solution</span>,FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span>    <span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span>,<span class="va">maxvalue</span>,<span class="va">cv</span><span class="op">)</span></span>
<span>    <span class="va">fitness</span> <span class="op">&lt;-</span> <span class="va">fitness</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">solution</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span>  <span class="co"># Penalisation on unbalanced clusters</span></span>
<span>  <span class="va">fitness</span> <span class="op">&lt;-</span> <span class="va">fitness</span> <span class="op">+</span> <span class="va">penalfactor</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">b</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">fitness</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="optimization-1">Optimization<a class="anchor" aria-label="anchor" href="#optimization-1"></a>
</h4>
<p>To ensure good results to the GA we give a number of iterations
(2500) that is much higher than the one given to the QGA (1500).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">solution_genalg</span> <span class="op">&lt;-</span> <span class="fu">rbga</span><span class="op">(</span>stringMin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                   stringMax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">nclust</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   popSize<span class="op">=</span><span class="fl">20</span>, </span>
<span>                   iters<span class="op">=</span><span class="fl">3000</span>, </span>
<span>                   elitism<span class="op">=</span><span class="cn">NA</span>, </span>
<span>                   mutationChance <span class="op">=</span> <span class="fl">5</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                   evalFunc<span class="op">=</span><span class="va">evaluate</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solution_genalg</span><span class="op">)</span></span></code></pre></div>
<p><img src="clustering_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="analysis-of-the-solution-1">Analysis of the solution<a class="anchor" aria-label="anchor" href="#analysis-of-the-solution-1"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filter</span> <span class="op">=</span> <span class="va">solution_genalg</span><span class="op">$</span><span class="va">evaluations</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">solution_genalg</span><span class="op">$</span><span class="va">evaluations</span><span class="op">)</span></span>
<span><span class="va">bestObjectCount</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">solution_genalg</span><span class="op">$</span><span class="va">popSize</span><span class="op">)</span><span class="op">[</span><span class="va">filter</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">bestObjectCount</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">bestSolution</span> <span class="op">=</span> <span class="va">solution_genalg</span><span class="op">$</span><span class="va">population</span><span class="op">[</span><span class="va">filter</span>, <span class="op">]</span><span class="op">[</span><span class="fl">1</span>, </span>
<span>  <span class="op">]</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">bestSolution</span> <span class="op">=</span> <span class="va">solution_genalg</span><span class="op">$</span><span class="va">population</span><span class="op">[</span><span class="va">filter</span>, <span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="va">bestSolution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">bestSolution</span><span class="op">)</span></span>
<span><span class="va">fitnessGA</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">v</span> <span class="kw">in</span> <span class="va">vars</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="va">v</span><span class="op">]</span>,<span class="va">bestSolution</span>,FUN<span class="op">=</span><span class="va">sd</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="va">v</span><span class="op">]</span>,<span class="va">bestSolution</span>,FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span>,<span class="va">maxvalue</span>,<span class="va">cv</span><span class="op">)</span></span>
<span>  <span class="va">fitnessGA</span> <span class="op">&lt;-</span> <span class="va">fitnessGA</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">fitnessGA</span></span>
<span><span class="co">#&gt; [1] 1.857548</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitnessQGA</span></span>
<span><span class="co">#&gt; [1] 1.62336</span></span></code></pre></div>
<p>Also considering the obtained stratification:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span><span class="op">$</span><span class="va">stratum</span> <span class="op">&lt;-</span> <span class="va">bestSolution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, <span class="va">iris</span><span class="op">$</span><span class="va">stratum</span><span class="op">)</span></span>
<span><span class="co">#&gt;             </span></span>
<span><span class="co">#&gt;               1  2  3</span></span>
<span><span class="co">#&gt;   setosa      0 50  0</span></span>
<span><span class="co">#&gt;   versicolor 12  0 38</span></span>
<span><span class="co">#&gt;   virginica  38  0 12</span></span></code></pre></div>
<p>the classic GA one is less in line with the “natural” one.</p>
</div>
</div>
<div class="section level3">
<h3 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h3>
<p>In this case, the Quantum GA is more efficient than the classical
GA.</p>
<p>In general, when the number of values that each element in the genome
can assume is not high (in this case, there are only 3 different
values), then a relative efficiency of the QGA is to be expected. When
the number of these values is high, the classical GA tends to be more
efficient.</p>
<p>This is because the QGA needs to define a number of qubits that is
the integer ceiling value of log(n) (in our case n=3, so the number of
qubits is 2). The length of the solution is given by the product of the
length of the genome (in our case 150) by the number of qubits necessary
for each element of the genome, so 150x2=300.</p>
<p>On the contrary, the classical GA can work directly on an integer
representation of the values for each element of the genome, so the
length of the solution does not increase.</p>
<p>When the n is high, the length of the solution treated by the QGA is
much higher than that of the solution treated by the classical GA, so
the latter can be more efficient than the former.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Giulio Barcaroli.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
